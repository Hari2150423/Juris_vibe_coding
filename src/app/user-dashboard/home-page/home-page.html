<div class="home-page-container">
  <div class="welcome-section">
    <h1>Welcome, {{ (currentUser | async)?.name }}!</h1>
    <p>Mark your roaster dates</p>
  </div>

  <!-- Previous Selection Info Section -->
  <div class="previous-selection-section" *ngIf="hasPreviousSelection && !showEditMode">
    <div class="selection-info">
      <h3>Your Current Roaster Selection</h3>
      <p class="saved-time">Last saved: {{ formatSavedTime(previousSelectionSavedAt) }}</p>
      <div class="dates-summary">
        <p><strong>{{ previousSelectionDates.length }} dates selected</strong></p>
        <div class="dates-preview">
          <span class="date-chip" *ngFor="let date of previousSelectionDates.slice(0, 3)">
            {{ formatDate(date) }}
          </span>
          <span *ngIf="previousSelectionDates.length > 3" class="more-dates">
            +{{ previousSelectionDates.length - 3 }} more
          </span>
        </div>
      </div>
      <div class="status-tag" *ngIf="status === 'pending'">
        <span class="info-tag info-pending">&#9432; Approval Pending</span>
      </div>
      <div class="status-tag" *ngIf="status === 'approved'">
        <span class="info-tag info-approved">&#10003; Approved</span>
      </div>
      <button class="edit-btn" (click)="enableEditMode()" *ngIf="!hideEditAndSubmit">
        Edit Selection
      </button>
      <button class="submit-btn" (click)="openSubmitModal()" *ngIf="!hideEditAndSubmit">
        Submit
      </button>
    </div>
  </div>
  
  <!-- Calendar Section -->
  <div class="calendar-section" *ngIf="!hasPreviousSelection || showEditMode">
    <div *ngIf="showEditMode" class="edit-mode-header">
      <h3>Edit Your Roaster Selection</h3>
      <p>Modify your previously selected dates below:</p>
      <button class="cancel-edit-btn" (click)="cancelEditMode()">
        Cancel Edit
      </button>
    </div>
    <app-calender-ui 
      [editMode]="showEditMode" 
      [preSelectedDates]="showEditMode ? previousSelectionDates : []"
      (editCompleted)="onEditCompleted()">
    </app-calender-ui>
  </div>

  <!-- Submit Confirmation Modal -->
  <div *ngIf="showSubmitModal" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-title-row">
        <h2>Confirm Your Dates</h2>
        <span class="selected-count-tag">{{ previousSelectionDates.length }} days selected</span>
      </div>
      <p>These are the chosen dates:</p>
      <ul>
        <li *ngFor="let date of previousSelectionDates"><span class="date-chip">{{ formatDate(date) }}</span></li>
      </ul>
      <p>Do you want to submit the above dates for admin approval?</p>
      <div class="modal-actions">
        <button class="edit-btn" (click)="confirmSubmit()">Confirm Submit</button>
        <button class="cancel-edit-btn" (click)="closeSubmitModal()">No</button>
      </div>
    </div>
  </div>
</div>
